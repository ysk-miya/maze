<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Timeã‚¢ã‚¿ãƒƒã‚¯</title>
    <style>
        body {
            background-image: url(../white.webp);
            background-size: cover;
            font-family: "Century Gothic";
            font-size: 16px;
        }

        #container {
            margin: 20px auto;
        }

        #mycanvas {
            text-align: center;
            background: white;
        }

        .btn {
            font-size: 26px;
            margin: auto;
            width: 100px;
            padding: 5px;
            background: #e62f8b;
            color: #FFFFFF;
            border-radius: 8px;
            cursor: pointer;
        }

        .myButton {
            font-size: 18px;
        }

        .btn:hover {
            opacity: 0.7;
        }

        .timer {
            float: left;
            display: flex;
        }

        .main {
            margin-left: 30px;
            display: flex;
            display: inline-block;
        }

        p {
            color: #e62f8b;
            font-size: 20px;
            margin-bottom: 0;
            margin-top: 0;
            /* visibility: hidden; */
        }

        .start {
            float: left;
        }

        .goal {
            float: right;
        }
    </style>
</head>

<body>

    <button class="btn" id="level10" data-level="10" onclick="start()">Start</button>

    <div id='container'>
        <div class="timer">
            <h1 id="timerLabel">00:00:00</h1>
            <!-- <input type="button" class="myButton" onclick="start()" value="START" id="startBtn"> -->
            <!-- <input type="button" class="myButton" onclick="stop()" value="STOP"> -->
            <input type="button" class="myButton" onclick="reset()" value="RESET">
        </div>
        <div class="main">
            <h4>â€»èµ¤å°ã¯å‹•ã‹ãªã„ã®ã§ " è¿½è¦– " ã§ã™ğŸ’¦</h4>
            <div class="start">
                <p>start</p>
            </div>
            <div><canvas width="100" height="100" id="mycanvas"></canvas></div>
            <div>
                <p class="goal">goal</p>
            </div>
        </div>
    </div>


    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js "></script>

    <script>
        $('.btn').click(function () {
            alert("ã‚´ãƒ¼ãƒ«ã¾ã§è¡Œã‘ãŸã‚‰ [ Enter ] ã‚’æŠ¼ã—ã¦ãã ã•ã„")
            alert("ã§ã¯ã€ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™ï¼")

            let map = [];

            // Canvasã§æç”»
            //ã“ã“ã®colã¨rowã®æ•°å­—ã‚’å¢—ã‚„ã›ã°ä½•åº¦ã¯ã©ã‚“ã©ã‚“é«˜ããªã‚‹
            let col = 111; // å¥‡æ•°ã§ãªã„ã¨é“ãŒå‡ºæ¥ãªã„
            let row = 65; //ç”»é¢ã«åã¾ã‚‹ã‚ˆã†å°‘ã—æ¨ªé•·ã§ã€‚

            for (let x = 0; x < col; x++) { //ãƒãƒƒãƒ—ã‚’å…¨éƒ¨ï¼ã§åŸ‹ã‚ã‚‹
                map[x] = [];
                for (let y = 0; y < row; y++) {
                    map[x][y] = 0;
                }
            }

            for (let x = 1; x < col; x += 2) {//ä¸€ã¤é£›ã³ã«å£ã‚’ä½œã‚‹((ï¼‘)ã®éƒ¨åˆ†),xï¼‹ï¼ï¼’ã¯ï¼‘ã€ï¼“ã€ï¼•ãƒ»ãƒ»ãƒ»
                for (let y = 1; y < row; y += 2) {
                    map[x][y] = 1;
                }
            }

            let points = [//å€’ã™éš›ã®é…åˆ—ï¼ã€œï¼“
                [0, -1],//ä¸Šã«å€’ã™
                [0, 1],//ä¸‹
                [1, 0],//å³
                [-1, 0]//ï¼Šï¼Šå·¦
            ]

            function rand(n) {
                return Math.floor(Math.random() * (n + 1));
            }

            for (let x = 1; x < col; x += 2) {
                for (let y = 1; y < row; y += 2) {
                    do {
                        if (x === 1) {
                            // ä¸Šä¸‹å·¦å³ã«å€’ã™
                            var r = points[rand(3)];
                        } else {
                            // å·¦ä»¥å¤–ã«å€’ã™
                            var r = points[rand(2)];
                        }
                    } while (map[x + r[0]][y + r[1]] === 1);//å€’ã—ãŸå…ˆãŒæ£’ã®å ´åˆã«ã¯ã‚„ã‚Šç›´ã—ãŸã„ã®ã§do,whileæ–‡
                    map[x + r[0]][y + r[1]] = 1;
                }
            }

            let startX = 0;//ã‚¹ã‚¿ãƒ¼ãƒˆã®åº§æ¨™
            let startY = 0;

            let goalX = col - 1;//ã‚´ãƒ¼ãƒ«ã®åº§æ¨™
            let goalY = row - 1;

            let wallSize = 10;
            let wallColor = '#3cb371';
            let routeColor = '#ff0000';


            const canvas = $('#mycanvas')[0];
            if (!canvas || !canvas.getContext) {
                return false;
            }
            const ctx = canvas.getContext('2d');

            canvas.width = (col + 2) * wallSize;//å·¦å³ã¨ã‚‚å£ã®åˆ†(ï¼‹ï¼’)
            canvas.height = (row + 2) * wallSize;//ä¸Šä¸‹ã‚‚åŒæ§˜

            // ä¸Šä¸‹ã®å£
            for (let x = 0; x < col + 2; x++) {
                drawWall(x, 0);
                drawWall(x, row + 1);
            }

            // å·¦å³ã®å£
            for (let y = 0; y < row + 2; y++) {
                drawWall(0, y);
                drawWall(col + 1, y);
            }

            // è¿·è·¯ã®å†…éƒ¨
            for (let x = 0; x < col; x++) {
                for (let y = 0; y < row; y++) {
                    if (map[x][y] === 1) {
                        drawWall(x + 1, y + 1);//ä¸¡æ–¹ã¨ã‚‚å£ã®åˆ†(ï¼‹ï¼‘)ã‚’è€ƒæ…®
                    }
                    if ((x === startX && y === startY) || (x === goalX && y === goalY)) {// ||ã‚‚ã—ãã¯
                        drawRoute(x + 1, y + 1);//ï¼‹ï¼‘ã¯å£ã‚’è€ƒæ…®
                    }
                }
            }

            // å£ã‚’æç”»
            function drawWall(x, y) {
                ctx.fillStyle = wallColor;//å£ã®è‰²
                drawRect(x, y);
            }

            function drawRoute(x, y) {
                ctx.fillStyle = routeColor;
                drawRect(x, y);
            }

            function drawRect(x, y) {
                ctx.fillRect(
                    x * wallSize,
                    y * wallSize,
                    wallSize,//å£ã®å¹…
                    wallSize);
            }


        });


        //ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒ

        let status = 0; // 0:åœæ­¢ä¸­ 1:å‹•ä½œä¸­
        let time = 0;
        let startBtn = document.getElementById("level10");
        let timerLabel = document.getElementById('timerLabel');
        // STARTãƒœã‚¿ãƒ³
        function start() {
            // å‹•ä½œä¸­ã«ã™ã‚‹
            status = 1;
            // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ãªã„ã‚ˆã†ã«ã™ã‚‹
            startBtn.disabled = true;
            timer();
        }
        // STOPãƒœã‚¿ãƒ³
        function stop() {
            // åœæ­¢ä¸­ã«ã™ã‚‹
            status = 0;
            // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
            startBtn.disabled = false;
        }
        // RESETãƒœã‚¿ãƒ³
        function reset() {
            // åœæ­¢ä¸­ã«ã™ã‚‹
            status = 0;
            // ã‚¿ã‚¤ãƒ ã‚’0ã«æˆ»ã™
            time = 0;
            // ã‚¿ã‚¤ãƒãƒ¼ãƒ©ãƒ™ãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆ
            timerLabel.innerHTML = '00:00:00';
            // ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
            startBtn.disabled = false;
        }
        function timer() {
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå‹•ä½œä¸­ã®å ´åˆã®ã¿å®Ÿè¡Œ
            if (status == 1) {
                setTimeout(function () {
                    time++;
                    // åˆ†ãƒ»ç§’ãƒ»ãƒŸãƒªç§’ã‚’è¨ˆç®—
                    let min = Math.floor(time / 100 / 60);
                    let sec = Math.floor(time / 100);
                    let mSec = time % 100;
                    // åˆ†ãŒï¼‘æ¡ã®å ´åˆã¯ã€å…ˆé ­ã«ï¼ã‚’ã¤ã‘ã‚‹
                    if (min < 10) min = "0" + min;
                    // ç§’ãŒï¼–ï¼ç§’ä»¥ä¸Šã®å ´åˆã€€ä¾‹ï¼‰89ç§’â†’29ç§’ã«ã™ã‚‹
                    if (sec >= 60) sec = sec % 60;
                    // ç§’ãŒï¼‘æ¡ã®å ´åˆã¯ã€å…ˆé ­ã«ï¼ã‚’ã¤ã‘ã‚‹
                    if (sec < 10) sec = "0" + sec;

                    // ãƒŸãƒªç§’ãŒï¼‘æ¡ã®å ´åˆã¯ã€å…ˆé ­ã«ï¼ã‚’ã¤ã‘ã‚‹
                    if (mSec < 10) mSec = "0" + mSec;
                    // ã‚¿ã‚¤ãƒãƒ¼ãƒ©ãƒ™ãƒ«ã‚’æ›´æ–°
                    timerLabel.innerHTML = min + ":" + sec + ":" + mSec;
                    // å†ã³timer()ã‚’å‘¼ã³å‡ºã™
                    timer();
                }, 10);
            }
        }

        document.onkeydown = function (event) {
            if (event) {
                if (event.keyCode == 13 || event.which == 13) { //Enterã®ã‚­ãƒ¼ã‚³ãƒ¼ãƒ‰ãŒï¼‘ï¼“
                    if (status == 1) {
                        stop();
                    } else if (status == 0) {
                        start();
                    }
                }
            }
        };

        //resetãƒœã‚¿ãƒ³ã§æ›´æ–°
        $("#reset").on("click", function () {
            location.reload();
        });

    </script>

</body>

</html>